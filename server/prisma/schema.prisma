generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("client") // "admin" or "client"
  createdAt DateTime @default(now())
  orders    Order[]  @relation("ClientOrders")
  bookings  Booking[]
}

model Order {
  id         String   @id @default(cuid())
  client     User     @relation(fields: [clientId], references: [id], name: "ClientOrders")
  clientId   String
  status     String   @default("new")
  totalCents Int      @default(0)
  stripePaymentIntentId String?
  paymentStatus String @default("pending")
  updatedAt  DateTime @updatedAt
  createdAt  DateTime @default(now())
  media      Media[]
  bookings   Booking[]
}

model Media {
  id        String   @id @default(cuid())
  order     Order?   @relation(fields: [orderId], references: [id])
  orderId   String?
  url       String
  kind      String   // image | video | other
  createdAt DateTime @default(now())
}

model Service {
  id         String   @id @default(cuid())
  name       String
  description String?
  priceCents Int
  createdAt  DateTime @default(now())
  bookings   Booking[]
}

model Booking {
  id         String   @id @default(cuid())
  client     User     @relation(fields: [clientId], references: [id])
  clientId   String
  service    Service? @relation(fields: [serviceId], references: [id])
  serviceId  String?
  scheduledAt DateTime
  location    String?
  notes       String?
  status      String   @default("scheduled") // scheduled, completed, canceled
  createdAt   DateTime @default(now())
  order       Order?   @relation(fields: [orderId], references: [id])
  orderId     String?
}
